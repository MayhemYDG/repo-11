// Code generated - EDITING IS FUTILE. DO NOT EDIT.
//
// Generated by pipeline:
//     terraform
// Using jennies:
//     TerraformDataSourceJenny
//     LatestJenny
//
// Run 'go generate ./' from repository root to regenerate.

package provider

import (
	"context"
	"encoding/json"

	"github.com/hashicorp/terraform-plugin-framework/datasource"
	"github.com/hashicorp/terraform-plugin-framework/datasource/schema"
	"github.com/hashicorp/terraform-plugin-framework/types"
	"github.com/hashicorp/terraform-plugin-log/tflog"
)

// Ensure provider defined types fully satisfy framework interfaces.
var (
	_ datasource.DataSource              = &CoreDashboardDataSource{}
	_ datasource.DataSourceWithConfigure = &CoreDashboardDataSource{}
)

func NewCoreDashboardDataSource() datasource.DataSource {
	return &CoreDashboardDataSource{}
}

// CoreDashboardDataSource defines the data source implementation.
type CoreDashboardDataSource struct{}

// CoreDashboardDataSourceModel describes the data source data model.
type CoreDashboardDataSourceModel struct {
	Id           types.Int64  `tfsdk:"id" json:"id"`
	Uid          types.String `tfsdk:"uid" json:"uid"`
	Title        types.String `tfsdk:"title" json:"title"`
	Description  types.String `tfsdk:"description" json:"description"`
	Revision     types.Int64  `tfsdk:"revision" json:"revision"`
	GnetId       types.String `tfsdk:"gnet_id" json:"gnetId"`
	Tags         types.List   `tfsdk:"tags" json:"tags"`
	Style        types.String `tfsdk:"style" json:"style"`
	Timezone     types.String `tfsdk:"timezone" json:"timezone"`
	Editable     types.Bool   `tfsdk:"editable" json:"editable"`
	GraphTooltip types.Int64  `tfsdk:"graph_tooltip" json:"graphTooltip"`
	Time         *struct {
		From types.String `tfsdk:"from" json:"from"`
		To   types.String `tfsdk:"to" json:"to"`
	} `tfsdk:"time" json:"time"`
	Timepicker *struct {
		Collapse         types.Bool `tfsdk:"collapse" json:"collapse"`
		Enable           types.Bool `tfsdk:"enable" json:"enable"`
		Hidden           types.Bool `tfsdk:"hidden" json:"hidden"`
		RefreshIntervals types.List `tfsdk:"refresh_intervals" json:"refresh_intervals"`
		TimeOptions      types.List `tfsdk:"time_options" json:"time_options"`
	} `tfsdk:"timepicker" json:"timepicker"`
	FiscalYearStartMonth types.Int64  `tfsdk:"fiscal_year_start_month" json:"fiscalYearStartMonth"`
	LiveNow              types.Bool   `tfsdk:"live_now" json:"liveNow"`
	WeekStart            types.String `tfsdk:"week_start" json:"weekStart"`
	SchemaVersion        types.Int64  `tfsdk:"schema_version" json:"schemaVersion"`
	Version              types.Int64  `tfsdk:"version" json:"version"`
	Panels               types.List   `tfsdk:"panels" json:"panels"`
	Templating           *struct {
		List []struct {
			Id           types.String `tfsdk:"id" json:"id"`
			Type         types.String `tfsdk:"type" json:"type"`
			Name         types.String `tfsdk:"name" json:"name"`
			Label        types.String `tfsdk:"label" json:"label"`
			RootStateKey types.String `tfsdk:"root_state_key" json:"rootStateKey"`
			Global       types.Bool   `tfsdk:"global" json:"global"`
			Hide         types.Int64  `tfsdk:"hide" json:"hide"`
			SkipUrlSync  types.Bool   `tfsdk:"skip_url_sync" json:"skipUrlSync"`
			Index        types.Int64  `tfsdk:"index" json:"index"`
			State        types.String `tfsdk:"state" json:"state"`
			Error        *struct {
			} `tfsdk:"error" json:"error"`
			Description types.String `tfsdk:"description" json:"description"`
			Datasource  *struct {
				Type types.String `tfsdk:"type" json:"type"`
				Uid  types.String `tfsdk:"uid" json:"uid"`
			} `tfsdk:"datasource" json:"datasource"`
		} `tfsdk:"list" json:"list"`
	} `tfsdk:"templating" json:"templating"`
	Annotations *struct {
		List []struct {
			Datasource *struct {
				Type types.String `tfsdk:"type" json:"type"`
				Uid  types.String `tfsdk:"uid" json:"uid"`
			} `tfsdk:"datasource" json:"datasource"`
			Enable    types.Bool   `tfsdk:"enable" json:"enable"`
			Name      types.String `tfsdk:"name" json:"name"`
			BuiltIn   types.Int64  `tfsdk:"built_in" json:"builtIn"`
			Hide      types.Bool   `tfsdk:"hide" json:"hide"`
			IconColor types.String `tfsdk:"icon_color" json:"iconColor"`
			Type      types.String `tfsdk:"type" json:"type"`
			RawQuery  types.String `tfsdk:"raw_query" json:"rawQuery"`
			ShowIn    types.Int64  `tfsdk:"show_in" json:"showIn"`
			Target    *struct {
				Limit    types.Int64  `tfsdk:"limit" json:"limit"`
				MatchAny types.Bool   `tfsdk:"match_any" json:"matchAny"`
				Tags     types.List   `tfsdk:"tags" json:"tags"`
				Type     types.String `tfsdk:"type" json:"type"`
			} `tfsdk:"target" json:"target"`
		} `tfsdk:"list" json:"list"`
	} `tfsdk:"annotations" json:"annotations"`
	Links []struct {
		Title       types.String `tfsdk:"title" json:"title"`
		Type        types.String `tfsdk:"type" json:"type"`
		Icon        types.String `tfsdk:"icon" json:"icon"`
		Tooltip     types.String `tfsdk:"tooltip" json:"tooltip"`
		Url         types.String `tfsdk:"url" json:"url"`
		Tags        types.List   `tfsdk:"tags" json:"tags"`
		AsDropdown  types.Bool   `tfsdk:"as_dropdown" json:"asDropdown"`
		TargetBlank types.Bool   `tfsdk:"target_blank" json:"targetBlank"`
		IncludeVars types.Bool   `tfsdk:"include_vars" json:"includeVars"`
		KeepTime    types.Bool   `tfsdk:"keep_time" json:"keepTime"`
	} `tfsdk:"links" json:"links"`
	Snapshot *struct {
		Created     types.String `tfsdk:"created" json:"created"`
		Expires     types.String `tfsdk:"expires" json:"expires"`
		External    types.Bool   `tfsdk:"external" json:"external"`
		ExternalUrl types.String `tfsdk:"external_url" json:"externalUrl"`
		Id          types.Int64  `tfsdk:"id" json:"id"`
		Key         types.String `tfsdk:"key" json:"key"`
		Name        types.String `tfsdk:"name" json:"name"`
		OrgId       types.Int64  `tfsdk:"org_id" json:"orgId"`
		Updated     types.String `tfsdk:"updated" json:"updated"`
		Url         types.String `tfsdk:"url" json:"url"`
		UserId      types.Int64  `tfsdk:"user_id" json:"userId"`
	} `tfsdk:"snapshot" json:"snapshot"`
	ToJSON types.String `tfsdk:"to_json"`
}

func (d *CoreDashboardDataSource) Metadata(ctx context.Context, req datasource.MetadataRequest, resp *datasource.MetadataResponse) {
	resp.TypeName = req.ProviderTypeName + "_core_dashboard"
}

func (d *CoreDashboardDataSource) Schema(ctx context.Context, req datasource.SchemaRequest, resp *datasource.SchemaResponse) {
	resp.Schema = schema.Schema{
		// This description is used by the documentation generator and the language server.
		MarkdownDescription: "TODO description",

		Attributes: map[string]schema.Attribute{
			"id": schema.Int64Attribute{
				MarkdownDescription: `Unique numeric identifier for the dashboard.
TODO must isolate or remove identifiers local to a Grafana instance...?`,
				Computed: false,
				Optional: true,
				Required: false,
			},

			"uid": schema.StringAttribute{
				MarkdownDescription: `Unique dashboard identifier that can be generated by anyone. string (8-40)`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"title": schema.StringAttribute{
				MarkdownDescription: `Title of dashboard.`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"description": schema.StringAttribute{
				MarkdownDescription: `Description of dashboard.`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"revision": schema.Int64Attribute{
				MarkdownDescription: `Version of the current dashboard data`,
				Computed:            false,
				Optional:            false,
				Required:            true,
			},

			"gnet_id": schema.StringAttribute{
				MarkdownDescription: ``,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"tags": schema.ListAttribute{
				MarkdownDescription: `Tags associated with dashboard.`,
				Computed:            false,
				Optional:            true,
				Required:            false,
				ElementType:         types.StringType,
			},

			"style": schema.StringAttribute{
				MarkdownDescription: `Theme of dashboard.`,
				Computed:            false,
				Optional:            false,
				Required:            true,
			},

			"timezone": schema.StringAttribute{
				MarkdownDescription: `Timezone of dashboard. Accepts IANA TZDB zone ID or "browser" or "utc".`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"editable": schema.BoolAttribute{
				MarkdownDescription: `Whether a dashboard is editable or not.`,
				Computed:            false,
				Optional:            false,
				Required:            true,
			},

			"graph_tooltip": schema.Int64Attribute{
				MarkdownDescription: `Configuration of dashboard cursor sync behavior.`,
				Computed:            false,
				Optional:            false,
				Required:            true,
			},

			"time": schema.SingleNestedAttribute{
				MarkdownDescription: `Time range for dashboard, e.g. last 6 hours, last 7 days, etc`,
				Computed:            false,
				Optional:            true,
				Required:            false,
				Attributes: map[string]schema.Attribute{
					"from": schema.StringAttribute{
						MarkdownDescription: ``,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"to": schema.StringAttribute{
						MarkdownDescription: ``,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},
				},
			},

			"timepicker": schema.SingleNestedAttribute{
				MarkdownDescription: `TODO docs
TODO this appears to be spread all over in the frontend. Concepts will likely need tidying in tandem with schema changes`,
				Computed: false,
				Optional: true,
				Required: false,
				Attributes: map[string]schema.Attribute{
					"collapse": schema.BoolAttribute{
						MarkdownDescription: `Whether timepicker is collapsed or not.`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"enable": schema.BoolAttribute{
						MarkdownDescription: `Whether timepicker is enabled or not.`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"hidden": schema.BoolAttribute{
						MarkdownDescription: `Whether timepicker is visible or not.`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"refresh_intervals": schema.ListAttribute{
						MarkdownDescription: `Selectable intervals for auto-refresh.`,
						Computed:            false,
						Optional:            false,
						Required:            true,
						ElementType:         types.StringType,
					},

					"time_options": schema.ListAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
						ElementType:         types.StringType,
					},
				},
			},

			"fiscal_year_start_month": schema.Int64Attribute{
				MarkdownDescription: `The month that the fiscal year starts on.  0 = January, 11 = December`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"live_now": schema.BoolAttribute{
				MarkdownDescription: `TODO docs`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"week_start": schema.StringAttribute{
				MarkdownDescription: `TODO docs`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"schema_version": schema.Int64Attribute{
				MarkdownDescription: `Version of the JSON schema, incremented each time a Grafana update brings
changes to said schema.
TODO this is the existing schema numbering system. It will be replaced by Thema's themaVersion`,
				Computed: false,
				Optional: false,
				Required: true,
			},

			"version": schema.Int64Attribute{
				MarkdownDescription: `Version of the dashboard, incremented each time the dashboard is updated.`,
				Computed:            false,
				Optional:            true,
				Required:            false,
			},

			"panels": schema.ListAttribute{
				MarkdownDescription: ``,
				Computed:            false,
				Optional:            true,
				Required:            false,
				ElementType:         types.StringType,
			},

			"templating": schema.SingleNestedAttribute{
				MarkdownDescription: `TODO docs`,
				Computed:            false,
				Optional:            true,
				Required:            false,
				Attributes: map[string]schema.Attribute{
					"list": schema.ListNestedAttribute{
						MarkdownDescription: ``,
						Computed:            false,
						Optional:            true,
						Required:            false,
						NestedObject: schema.NestedAttributeObject{
							Attributes: map[string]schema.Attribute{
								"id": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"type": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"name": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"label": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"root_state_key": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"global": schema.BoolAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"hide": schema.Int64Attribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"skip_url_sync": schema.BoolAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"index": schema.Int64Attribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"state": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"error": schema.SingleNestedAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"description": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"datasource": schema.SingleNestedAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            true,
									Required:            false,
									Attributes: map[string]schema.Attribute{
										"type": schema.StringAttribute{
											MarkdownDescription: `The plugin type-id`,
											Computed:            false,
											Optional:            true,
											Required:            false,
										},

										"uid": schema.StringAttribute{
											MarkdownDescription: `Specific datasource instance`,
											Computed:            false,
											Optional:            true,
											Required:            false,
										},
									},
								},
							},
						},
					},
				},
			},

			"annotations": schema.SingleNestedAttribute{
				MarkdownDescription: `TODO docs`,
				Computed:            false,
				Optional:            true,
				Required:            false,
				Attributes: map[string]schema.Attribute{
					"list": schema.ListNestedAttribute{
						MarkdownDescription: ``,
						Computed:            false,
						Optional:            true,
						Required:            false,
						NestedObject: schema.NestedAttributeObject{
							Attributes: map[string]schema.Attribute{
								"datasource": schema.SingleNestedAttribute{
									MarkdownDescription: `Datasource to use for annotation.`,
									Computed:            false,
									Optional:            false,
									Required:            true,
									Attributes: map[string]schema.Attribute{
										"type": schema.StringAttribute{
											MarkdownDescription: ``,
											Computed:            false,
											Optional:            true,
											Required:            false,
										},

										"uid": schema.StringAttribute{
											MarkdownDescription: ``,
											Computed:            false,
											Optional:            true,
											Required:            false,
										},
									},
								},

								"enable": schema.BoolAttribute{
									MarkdownDescription: `Whether annotation is enabled.`,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"name": schema.StringAttribute{
									MarkdownDescription: `Name of annotation.`,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"built_in": schema.Int64Attribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"hide": schema.BoolAttribute{
									MarkdownDescription: `Whether to hide annotation.`,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"icon_color": schema.StringAttribute{
									MarkdownDescription: `Annotation icon color.`,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"type": schema.StringAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"raw_query": schema.StringAttribute{
									MarkdownDescription: `Query for annotation data.`,
									Computed:            false,
									Optional:            true,
									Required:            false,
								},

								"show_in": schema.Int64Attribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            false,
									Required:            true,
								},

								"target": schema.SingleNestedAttribute{
									MarkdownDescription: ``,
									Computed:            false,
									Optional:            true,
									Required:            false,
									Attributes: map[string]schema.Attribute{
										"limit": schema.Int64Attribute{
											MarkdownDescription: ``,
											Computed:            false,
											Optional:            false,
											Required:            true,
										},

										"match_any": schema.BoolAttribute{
											MarkdownDescription: ``,
											Computed:            false,
											Optional:            false,
											Required:            true,
										},

										"tags": schema.ListAttribute{
											MarkdownDescription: ``,
											Computed:            false,
											Optional:            false,
											Required:            true,
											ElementType:         types.StringType,
										},

										"type": schema.StringAttribute{
											MarkdownDescription: ``,
											Computed:            false,
											Optional:            false,
											Required:            true,
										},
									},
								},
							},
						},
					},
				},
			},

			"links": schema.ListNestedAttribute{
				MarkdownDescription: `TODO docs`,
				Computed:            false,
				Optional:            true,
				Required:            false,
				NestedObject: schema.NestedAttributeObject{
					Attributes: map[string]schema.Attribute{
						"title": schema.StringAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"type": schema.StringAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"icon": schema.StringAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"tooltip": schema.StringAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"url": schema.StringAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"tags": schema.ListAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
							ElementType:         types.StringType,
						},

						"as_dropdown": schema.BoolAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"target_blank": schema.BoolAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"include_vars": schema.BoolAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},

						"keep_time": schema.BoolAttribute{
							MarkdownDescription: ``,
							Computed:            false,
							Optional:            false,
							Required:            true,
						},
					},
				},
			},

			"snapshot": schema.SingleNestedAttribute{
				MarkdownDescription: ``,
				Computed:            false,
				Optional:            true,
				Required:            false,
				Attributes: map[string]schema.Attribute{
					"created": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"expires": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"external": schema.BoolAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"external_url": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"id": schema.Int64Attribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"key": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"name": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"org_id": schema.Int64Attribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"updated": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},

					"url": schema.StringAttribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            true,
						Required:            false,
					},

					"user_id": schema.Int64Attribute{
						MarkdownDescription: `TODO docs`,
						Computed:            false,
						Optional:            false,
						Required:            true,
					},
				},
			},

			"to_json": schema.StringAttribute{
				Computed:            true,
				MarkdownDescription: "This datasource rendered as JSON",
			},
		},
	}
}

func (d *CoreDashboardDataSource) Configure(ctx context.Context, req datasource.ConfigureRequest, resp *datasource.ConfigureResponse) {
}

func (d *CoreDashboardDataSource) Read(ctx context.Context, req datasource.ReadRequest, resp *datasource.ReadResponse) {
	var data CoreDashboardDataSourceModel

	// Read Terraform configuration data into the model
	resp.Diagnostics.Append(req.Config.Get(ctx, &data)...)

	if resp.Diagnostics.HasError() {
		return
	}

	JSONConfig, err := json.Marshal(data)
	if err != nil {
		resp.Diagnostics.AddError("JSON marshalling error", err.Error())
		return
	}

	// fix up the panel Attribute
	// Read into a map[string]interface{} and then marshal it back to JSON
	// This is a workaround for the fact that the panel attribute should be a list of maps but is a list of json strings
	dataMap := make(map[string]interface{})
	err = json.Unmarshal(JSONConfig, &dataMap)
	if err != nil {
		resp.Diagnostics.AddError("JSON marshalling error", err.Error())
		return
	}
	panels := data.Panels.Elements()
	panelsMaps := make([]map[string]interface{}, len(panels))
	for i, panel := range panels {
		panelMap := make(map[string]interface{})
		err = json.Unmarshal([]byte(panel.String()), &panelMap)
		if err != nil {
			resp.Diagnostics.AddError("JSON marshalling error", err.Error())
			return
		}
		panelsMaps[i] = panelMap
	}

	dataMap["panels"] = panelsMaps

	// Not sure about that
	data.ToJSON = types.StringValue(string(JSONConfig))

	// Write logs using the tflog package
	// Documentation: https://terraform.io/plugin/log
	tflog.Trace(ctx, "read a data source")

	// Save data into Terraform state
	resp.Diagnostics.Append(resp.State.Set(ctx, &data)...)
}
